<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Budget Buddy</title>

  <link rel="stylesheet" href="./styles.css" />

  <!-- If you don't have manifest.json yet, you can remove this line -->
  <link rel="manifest" href="./manifest.json" />
  <meta name="theme-color" content="#ff6a00" />
</head>

<body>

  <!-- ===== Top Bar ===== -->
  <header class="topBar">
    <div class="topTitle">Budget Buddy</div>
    <button id="btnSettings" class="iconBtn" aria-label="Settings">⚙️</button>
  </header>

  <!-- ===== Screens ===== -->
  <main id="screens">

    <!-- TODAY -->
    <section id="screenToday" class="screen">
      <div class="card">
        <div class="cardTitle">Today</div>
        <div class="bigNumber" id="todaySnacksLeft">$0.00</div>
        <div class="smallLabel">Snacks left today</div>
      </div>

      <div class="grid2">
        <div class="card">
          <div class="cardTitle">Entertainment</div>
          <div class="bigNumber" id="balEnt">$0.00</div>
          <div class="smallLabel">Balance</div>
        </div>

        <div class="card">
          <div class="cardTitle">TP Fund</div>
          <div class="bigNumber" id="balTP">$0.00</div>
          <div class="smallLabel">Balance</div>
        </div>
      </div>

      <div class="card">
        <div class="rowBetween">
          <div>
            <div class="cardTitle">Snacks</div>
            <div class="smallLabel">Balance</div>
          </div>
          <div class="bigNumber" id="balSnacks">$0.00</div>
        </div>
      </div>

      <div class="card">
        <div class="rowBetween">
          <div>
            <div class="cardTitle">Savings</div>
            <div class="smallLabel">Balance</div>
          </div>
          <div class="bigNumber" id="balSavings">$0.00</div>
        </div>
      </div>
    </section>

    <!-- HISTORY -->
    <section id="screenHistory" class="screen hidden">
      <div class="card">
        <div class="cardTitle">History</div>
        <div class="smallLabel">Purchases and check actions (coming next)</div>
      </div>

      <div class="card">
        <div id="historyList" class="smallLabel">No history yet.</div>
      </div>
    </section>

    <!-- CALENDAR -->
    <section id="screenCalendar" class="screen hidden">
      <div class="card">
        <div class="cardTitle">Calendar</div>
        <div class="smallLabel">Manage PTO and workdays (Tue/Wed off, Sat/Sun workdays)</div>
      </div>

      <div class="card">
        <div class="smallLabel">PTO dates (temporary UI)</div>
        <div class="rowGap">
          <input id="ptoDate" type="date" />
          <button id="btnAddPTO" class="secondaryBtn">Add PTO Date</button>
          <div id="ptoList" class="smallLabel"></div>
        </div>
      </div>
    </section>

    <!-- MANAGE (Bills + edit) -->
    <section id="screenManage" class="screen hidden">
      <div class="card">
        <div class="cardTitle">Manage</div>
        <div class="smallLabel">Bills holding + recurring bills (wiring next)</div>
      </div>

      <div class="card">
        <div class="rowGap">
          <label class="field">
            <span>Bill name</span>
            <input id="billName" type="text" placeholder="Rent / Phone / AppleCare..." />
          </label>

          <label class="field">
            <span>Amount</span>
            <input id="billAmount" type="number" inputmode="decimal" step="0.01" placeholder="0.00" />
          </label>

          <label class="field">
            <span>Due date</span>
            <input id="billDue" type="date" />
          </label>

          <button id="btnAddBill" class="primaryBtn">Add / Update Bill</button>
          <div id="billsList" class="smallLabel"></div>
        </div>
      </div>
    </section>

  </main>

  <!-- ===== Bottom Nav ===== -->
  <nav class="bottomNav" aria-label="Bottom navigation">
    <button class="navBtn active" data-screen="screenToday" id="navToday">Today</button>
    <button class="navBtn" data-screen="screenHistory" id="navHistory">History</button>

    <button class="navAdd" id="btnAdd" aria-label="Add">+</button>

    <button class="navBtn" data-screen="screenCalendar" id="navCalendar">Calendar</button>
    <button class="navBtn" data-screen="screenManage" id="navManage">Manage</button>
  </nav>

  <!-- ===== Add Sheet (New Check / Purchase chooser) ===== -->
  <div id="sheetOverlay" class="overlay hidden"></div>

  <div id="sheetAdd" class="sheet hidden" role="dialog" aria-modal="true">
    <div class="sheetHeader">
      <div class="sheetTitle">Add</div>
      <button id="btnCloseSheetAdd" class="iconBtn" aria-label="Close">✕</button>
    </div>

    <div class="rowGap">
      <button id="btnOpenNewCheck" class="primaryBtn">New Check</button>
      <button id="btnOpenPurchase" class="secondaryBtn">Purchase</button>
    </div>
  </div>

  <!-- ===== Purchase Sheet ===== -->
  <div id="sheetPurchase" class="sheet hidden" role="dialog" aria-modal="true">
    <div class="sheetHeader">
      <div class="sheetTitle">Purchase</div>
      <button id="btnCloseSheetPurchase" class="iconBtn" aria-label="Close">✕</button>
    </div>

    <div class="card">
      <div class="cardTitle">Quick purchase</div>
      <div class="grid2">
        <button class="qpBtn" data-cat="snacks" data-amt="2.50">Snack $2.50</button>
        <button class="qpBtn" data-cat="snacks" data-amt="4.00">Snack $4.00</button>
        <button class="qpBtn" data-cat="ent" data-amt="10.00">Ent $10</button>
        <button class="qpBtn" data-cat="ent" data-amt="20.00">Ent $20</button>
      </div>
    </div>

    <div class="card">
      <div class="cardTitle">Custom purchase</div>

      <label class="field">
        <span>Amount</span>
        <input id="purchaseAmount" type="number" inputmode="decimal" step="0.01" placeholder="0.00" />
      </label>

      <label class="field">
        <span>Category</span>
        <select id="purchaseCategory">
          <option value="snacks">Snacks</option>
          <option value="ent">Entertainment</option>
          <option value="tp">TP</option>
        </select>
      </label>

      <button id="btnCheckPurchase" class="primaryBtn">Check</button>
      <pre id="purchaseDecision" class="mono"></pre>

      <button id="btnApplyPurchase" class="secondaryBtn">Apply</button>
    </div>
  </div>

  <!-- ===== New Check Sheet ===== -->
  <div id="sheetNewCheck" class="sheet hidden" role="dialog" aria-modal="true">
    <div class="sheetHeader">
      <div class="sheetTitle">New Check</div>
      <button id="btnCloseSheetNewCheck" class="iconBtn" aria-label="Close">✕</button>
    </div>

    <div class="card">
      <label class="field">
        <span>Deposit amount (actual)</span>
        <input id="checkDeposit" type="number" inputmode="decimal" step="0.01" placeholder="0.00" />
      </label>

      <label class="field">
        <span>Payday date</span>
        <input id="checkPayday" type="date" />
      </label>

      <label class="field">
        <span>Total debt (optional)</span>
        <input id="checkDebt" type="number" inputmode="decimal" step="0.01" placeholder="0.00" />
      </label>

      <button id="btnPreviewCheck" class="secondaryBtn">Preview</button>
      <pre id="checkPreviewOut" class="mono"></pre>

      <button id="btnApplyCheck" class="primaryBtn" disabled>Apply</button>
      <div class="smallLabel">Apply is disabled until we finish wiring the safe apply flow.</div>
    </div>
  </div>

  <!-- ===== SETTINGS MODAL ===== -->
  <div id="settingsOverlay" class="overlay hidden"></div>

  <div id="settingsModal" class="modal hidden" role="dialog" aria-modal="true" aria-labelledby="settingsTitle">
    <div class="modalHeader">
      <button id="btnSettingsClose" class="iconBtn" aria-label="Close settings">✕</button>
      <div class="modalTitleWrap">
        <div id="settingsTitle" class="modalTitle">Settings</div>
        <div class="modalSubtitle">Adjust balances, rules, and caps</div>
      </div>
    </div>

    <div class="tabBar">
      <button class="tabBtn active" data-tab="tabBalances">Starting Balances</button>
      <button class="tabBtn" data-tab="tabSplits">Split Rules</button>
      <button class="tabBtn" data-tab="tabCaps">Max Balances</button>
      <button class="tabBtn" data-tab="tabAdvanced">Advanced</button>
    </div>

    <div class="tabContent">
      <section id="tabBalances" class="tabPanel">
        <div class="formGrid">
          <label class="field">
            <span>Next paycheck date</span>
            <input id="setNextPayDate" type="date" />
          </label>

          <label class="field">
            <span>Snacks balance</span>
            <input id="setSnacks" type="number" inputmode="decimal" step="0.01" />
          </label>

          <label class="field">
            <span>Entertainment balance</span>
            <input id="setEnt" type="number" inputmode="decimal" step="0.01" />
          </label>

          <label class="field">
            <span>TP balance</span>
            <input id="setTP" type="number" inputmode="decimal" step="0.01" />
          </label>

          <label class="field">
            <span>Savings balance</span>
            <input id="setSavings" type="number" inputmode="decimal" step="0.01" />
          </label>
        </div>

        <div class="actionsRow">
          <button id="btnSettingsSaveBalances" class="primaryBtn">Save</button>
          <button id="btnSettingsRecalcSnack" class="secondaryBtn">Recalc today’s snack limit</button>
        </div>

        <div class="helperNote">
          Use this if balances ever get out of sync. Saving updates your stored state.
        </div>
      </section>

      <section id="tabSplits" class="tabPanel hidden">
        <div class="helperNote">
          Split Rules will be wired after New Check → Apply is enabled.
        </div>
      </section>

      <section id="tabCaps" class="tabPanel hidden">
        <div class="formGrid">
          <label class="field inlineField">
            <span>Enable caps</span>
            <input id="capEnable" type="checkbox" checked />
          </label>

          <label class="field inlineField">
            <span>Overflow → Savings</span>
            <input id="capOverflowToSavings" type="checkbox" checked />
          </label>

          <label class="field">
            <span>Snacks cap</span>
            <input id="capSnacks" type="number" inputmode="decimal" step="0.01" value="75" />
          </label>

          <label class="field">
            <span>Entertainment cap</span>
            <input id="capEnt" type="number" inputmode="decimal" step="0.01" value="75" />
          </label>

          <label class="field">
            <span>TP cap</span>
            <input id="capTP" type="number" inputmode="decimal" step="0.01" value="100" />
          </label>
        </div>

        <div class="helperNote">
          Caps are hard cutoffs. If overflow is enabled, extra goes into Savings.
        </div>

        <div class="actionsRow">
          <button id="btnSettingsSaveCaps" class="primaryBtn">Save caps</button>
        </div>
      </section>

      <section id="tabAdvanced" class="tabPanel hidden">
        <div class="formGrid">
          <label class="field inlineField">
            <span>Exclude Tuesdays (no snack allowance)</span>
            <input id="advExcludeTue" type="checkbox" checked />
          </label>

          <label class="field inlineField">
            <span>Exclude Wednesdays (no snack allowance)</span>
            <input id="advExcludeWed" type="checkbox" checked />
          </label>
        </div>

        <div class="helperNote">
          PTO management stays in the Calendar tab. Import/Export will live here later.
        </div>

        <div class="actionsRow">
          <button id="btnSettingsSaveAdvanced" class="primaryBtn">Save advanced</button>
        </div>
      </section>
    </div>
  </div>

  <!-- JS -->
  <script src="./app.js"></script>

  <!-- Service worker (optional) -->
  <script>
    if ('serviceWorker' in navigator) {
      navigator.serviceWorker.register('./sw.js').catch(() => {});
    }
  </script>

</body>
</html>
