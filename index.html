<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1,viewport-fit=cover" />
  <title>Budget Buddy</title>
  <link rel="manifest" href="manifest.webmanifest">
  <meta name="theme-color" content="#0b0b0b" />
  <link rel="stylesheet" href="styles.css">
</head>
<body>
  <header>
    <div>
      <div class="h1">Budget Buddy</div>
      <div class="sub" id="subLine">—</div>
    </div>
    <button id="btnMenu" class="ghost">☰</button>
  </header>

  <!-- Settings Drawer -->
  <div id="drawerBackdrop" class="backdrop hidden"></div>
  <aside id="drawer" class="drawer hidden">
    <div class="drawerTop">
      <div class="h2">Settings</div>
      <button id="btnCloseDrawer" class="ghost">✕</button>
    </div>

    <section class="card">
      <div class="h3">Import / Export</div>
      <button id="btnExport" class="wide">Export (copy)</button>
      <button id="btnExportFile" class="wide">Export (file)</button>
      <div class="sp8"></div>
      <textarea id="importBox" rows="6" placeholder="Paste exported code here..."></textarea>
      <button id="btnImport" class="wide primary">Import</button>
      <div class="muted">Import overwrites current data on this device.</div>
    </section>

    <section class="card">
      <div class="h3">Split defaults</div>
      <div class="grid2">
        <div>
          <label>Savings %</label>
          <input id="setSavingsPct" type="number" step="1" min="0" max="100">
        </div>
        <div>
          <label>TP per check</label>
          <input id="setTPFixed" type="number" step="0.01">
        </div>
        <div>
          <label>Snack cap (debt&gt;0)</label>
          <input id="setSnackCap" type="number" step="0.01">
        </div>
        <div>
          <label>Ent cap (debt&gt;0)</label>
          <input id="setEntCap" type="number" step="0.01">
        </div>
      </div>
      <div class="grid2">
        <div>
          <label>Snacks per check</label>
          <input id="setSnacksFixed" type="number" step="0.01">
        </div>
        <div>
          <label>Ent per check</label>
          <input id="setEntFixed" type="number" step="0.01">
        </div>
        <div>
          <label>TP cap</label>
          <input id="setTPCap" type="number" step="0.01">
        </div>
        <div>
          <label>Debt chunks</label>
          <input id="setDebtChunk" type="number" step="1" min="1">
        </div>
      </div>
      <button id="btnSaveSettings" class="wide primary">Save settings</button>
    </section>

    <section class="card">
      <div class="h3">Workday rules</div>
      <div class="row">
        <label class="chip"><input id="exTue" type="checkbox"> Exclude Tue</label>
        <label class="chip"><input id="exWed" type="checkbox"> Exclude Wed</label>
      </div>

      <div class="sp8"></div>
      <div class="h4">Temporary non-workdays (PTO) — auto-expire</div>
      <div class="row">
        <input id="ptoDate" type="date" />
        <input id="ptoLabel" type="text" placeholder="Label (optional)" />
        <button id="btnAddPTO" class="primary">Add</button>
      </div>
      <div id="ptoList" class="list"></div>
      <div class="muted">PTO dates automatically delete after the date passes.</div>
    </section>

    <section class="card">
      <div class="h3">Maintenance</div>
      <button id="btnReset" class="wide danger">Reset everything</button>
      <div class="muted" id="lastSaved">—</div>
    </section>
  </aside>

  <main>
    <!-- TODAY TAB -->
    <section id="tabToday" class="tab">
      <div class="card">
        <div class="grid3">
          <div class="stat">
            <div class="k">Days left</div>
            <div class="v" id="daysLeft">—</div>
          </div>
          <div class="stat">
            <div class="k">Workdays left</div>
            <div class="v" id="workdaysLeft">—</div>
          </div>
          <div class="stat">
            <div class="k">Snack cap locked for</div>
            <div class="v" id="lockedDay">—</div>
          </div>
        </div>
      </div>

      <div class="card">
        <div class="h2">Today limits</div>
        <div class="grid2">
          <div class="stat big">
            <div class="k">Snack cap today</div>
            <div class="v" id="snackCapToday">$0.00</div>
          </div>
          <div class="stat big">
            <div class="k">Snack left today</div>
            <div class="v" id="snackLeftToday">$0.00</div>
          </div>
        </div>
        <div class="muted">Snack cap auto-locks the first time you open the app each day.</div>
      </div>

      <div class="card">
        <div class="h2">Balances</div>
        <div class="grid2">
          <div class="stat">
            <div class="k">Bills Holding (funded)</div>
            <div class="v" id="balHolding">$0.00</div>
          </div>
          <div class="stat">
            <div class="k">Total Debt Remaining (Current + Cash App + Tilt)</div>
            <div class="v" id="balDebt">$0.00</div>
          </div>
          <div class="stat">
            <div class="k">Savings</div>
            <div class="v" id="balSavings">$0.00</div>
          </div>
          <div class="stat">
            <div class="k">TP Fund</div>
            <div class="v" id="balTP">$0.00</div>
          </div>
          <div class="stat">
            <div class="k">Snacks</div>
            <div class="v" id="balSnacks">$0.00</div>
          </div>
          <div class="stat">
            <div class="k">Entertainment</div>
            <div class="v" id="balEnt">$0.00</div>
          </div>
        </div>
      </div>

      <div class="card">
        <div class="h2">Can I buy this?</div>
        <div class="grid3">
          <div>
            <label>Amount</label>
            <input id="buyAmt" type="number" step="0.01" placeholder="e.g. 4.47">
          </div>
          <div>
            <label>Category</label>
            <select id="buyCat">
              <option value="snacks">Snacks (Best Buy)</option>
              <option value="ent">Entertainment</option>
              <option value="tp">TP Fund</option>
            </select>
          </div>
          <div>
            <label>&nbsp;</label>
            <button id="btnCheckBuy" class="wide primary">Check</button>
            <button id="btnApplyBuy" class="wide" disabled>Apply</button>
          </div>
        </div>
        <pre id="buyOut" class="mono"></pre>
      </div>
    </section>

    <!-- NEW CHECK TAB -->
    <section id="tabCheck" class="tab hidden">
      <div class="card">
        <div class="h2">New check</div>
        <div class="grid3">
          <div>
            <label>Deposit (net)</label>
            <input id="inDeposit" type="number" step="0.01" placeholder="e.g. 1312.62">
          </div>
          <div>
            <label>Next paycheck date</label>
            <input id="inNextPay" type="date">
          </div>
          <div>
            <label>Total debt remaining</label>
            <input id="inDebt" type="number" step="0.01" placeholder="Current + Cash App + Tilt">
          </div>
        </div>

        <button id="btnRunCheck" class="wide primary">Run payday plan</button>
        <pre id="checkOut" class="mono"></pre>
      </div>

      <div class="card">
        <div class="h2">Bills & recurring bills</div>
        <button id="btnAddBill" class="ghost">Add item</button>
        <div id="billList" class="list"></div>
        <div class="muted">
          Anything due before next check gets funded into Bills Holding.
          Recurring bills auto-generate each month/week so you don’t re-add them.
        </div>
      </div>
    </section>

    <!-- DEBT TAB -->
    <section id="tabDebt" class="tab hidden">
      <div class="card">
        <div class="h2">Debt tracker (only Current + Cash App + Tilt)</div>
        <div class="row">
          <div class="stat big" style="flex:1;">
            <div class="k">Total debt remaining</div>
            <div class="v" id="debtBig">$0.00</div>
          </div>
        </div>
        <div class="grid3">
          <button class="primary" data-debtpay="25">Mark paid $25</button>
          <button class="primary" data-debtpay="50">Mark paid $50</button>
          <button class="primary" data-debtpay="100">Mark paid $100</button>
        </div>
        <div class="sp8"></div>
        <div class="grid2">
          <input id="debtCustom" type="number" step="0.01" placeholder="Custom amount paid">
          <button id="btnDebtCustom" class="primary">Apply</button>
        </div>
        <div class="muted">This is manual on purpose, since set-aside items aren’t “paid” until they actually draft.</div>
      </div>
    </section>
  </main>

  <nav class="nav">
    <button class="navBtn active" data-tab="Today">Today</button>
    <button class="navBtn" data-tab="Check">New Check</button>
    <button class="navBtn" data-tab="Debt">Debt</button>
  </nav>

  <script src="app.js"></script>
  <script>
    if ('serviceWorker' in navigator) navigator.serviceWorker.register('sw.js');
  </script>
</body>
</html>
